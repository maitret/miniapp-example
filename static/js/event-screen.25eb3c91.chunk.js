(this["webpackJsonpminiapp-example"]=this["webpackJsonpminiapp-example"]||[]).push([[0],{305:function(e,t,a){"use strict";var l=a(0),c=a.n(l);t.a=({children:e,skeleton:t,intersectionOptions:a})=>{var n=Object(l.useRef)(null),s=function(e,t){var[a,c]=Object(l.useState)();return Object(l.useEffect)(()=>{if(e.current&&!a){var l=new IntersectionObserver(([e])=>{c(e.isIntersecting)},t);return l.observe(e.current),()=>{l.disconnect()}}},[e,t,a]),a}(n,a),[r,i]=Object(l.useState)(!1);return Object(l.useEffect)(()=>{s||i(!0)},[s]),c.a.createElement("div",{ref:n},s?e:r&&t)}},306:function(e,t,a){"use strict";var l=a(0),c=a.n(l),n=a(314),s=a.n(n);t.a=({children:e})=>c.a.createElement("h2",{className:s.a.title},e)},307:function(e,t,a){"use strict";var l=a(0),c=a.n(l),n=a(315),s=a.n(n);t.a=({children:e,className:t})=>c.a.createElement("div",{className:[s.a.block,t].filter(Boolean).join(" ")},e)},311:function(e,t,a){e.exports={modal:"styles_modal__2Q8g_",carousel:"styles_carousel__3JHc0",image:"styles_image__3O5qH",close:"styles_close__4LZBs",counter:"styles_counter__3PRwA"}},312:function(e,t,a){e.exports={container:"styles_container__3ZZwU",thumbnail:"styles_thumbnail__20t1x",image:"styles_image__QgQS0"}},313:function(e,t,a){e.exports={short:"styles_short__3k1iO",hidden:"styles_hidden__1LiUD",button:"styles_button__D0dDq"}},314:function(e,t,a){e.exports={title:"styles_title__2X6Eu"}},315:function(e,t,a){e.exports={block:"styles_block__1VDKZ"}},316:function(e,t,a){e.exports={cover:"styles_cover__13-3l",image:"styles_image__CjVbW",fade:"styles_fade__3F1Tn",overview:"styles_overview__1GrfL",title:"styles_title__3Zqkm",argument:"styles_argument__2fOy2",tags:"styles_tags__2NPR2"}},317:function(e,t,a){e.exports={container:"styles_container__1T1LA",title:"styles_title__5E4fn",price:"styles_price__31LNt",image:"styles_image__2FjaB",preview:"styles_preview__1Y7Wv"}},318:function(e,t,a){e.exports={container:"styles_container__23BU7",label:"styles_label__A0D9-",input:"styles_input__2Wcu3"}},319:function(e,t,a){e.exports={container:"styles_container__uQBDz",image:"styles_image__1Oif1",serviceName:"styles_serviceName__LjbiS",price:"styles_price__149aF"}},320:function(e,t,a){e.exports={modal:"styles_modal__3ZOE-",content:"styles_content__2-xA9",visible:"styles_visible__mfrBL",hidden:"styles_hidden__3bzBj",event:"styles_event__2u5Bc",input:"styles_input__gGp1k",total:"styles_total__2Y-X-",button:"styles_button__2SSOt"}},321:function(e,t,a){e.exports={static:"styles_static__2-03C",sticky:"styles_sticky__1Rl75","sticky-visible_yes":"styles_sticky-visible_yes__2Dqcw",slideUp:"styles_slideUp__39hv4","sticky-visible_no":"styles_sticky-visible_no__pKDDZ",slideDown:"styles_slideDown__2oDJ0",button:"styles_button__1odxN"}},322:function(e,t,a){e.exports={modal:"styles_modal__3Zspv",close:"styles_close__Yequy","close-button":"styles_close-button__1pQas","metro-containter":"styles_metro-containter__13P1B",station:"styles_station__3UP2f","metro-point":"styles_metro-point__1HHJ4"}},323:function(e,t,a){e.exports={map:"styles_map__1AUAZ"}},324:function(e,t,a){e.exports={title:"styles_title__1_HWs",address:"styles_address__Of4nL"}},325:function(e,t,a){e.exports={wrapper:"styles_wrapper__1GA7u",city:"styles_city__18Nw2",schedule:"styles_schedule__2bK7D",description:"styles_description__1TgUA",placeholder:"styles_placeholder__2Dhd8"}},337:function(e,t,a){"use strict";a.r(t);var l=a(0),c=a.n(l),n=a(2),s=a(95),r=a(37),i=a(46),o=a(64),m=a(311),u=a.n(m);var d=e=>{var[t,a]=Object(l.useState)(e.startIndex||0),n=Object(l.useRef)(null);return Object(l.useLayoutEffect)(()=>{var t;e.startIndex&&(n.current.scrollLeft=(t=e.startIndex,(window.innerWidth+20)*t))},[e.startIndex]),Object(l.useEffect)(()=>{var e=n.current,t=new IntersectionObserver(e=>{var t=e.reduce((e,t)=>t.intersectionRatio>e.intersectionRatio?t:e);if(t.intersectionRatio>0){var l=t.target,c=Array.prototype.indexOf.call(l.parentElement.children,l);a(c)}},{root:n.current,threshold:.5});for(var l of Array.from(e.children))t.observe(l);return()=>{t.disconnect()}},[e.items,e.startIndex]),Object(i.createPortal)(c.a.createElement("div",{className:u.a.modal},c.a.createElement("div",{className:u.a.counter},t+1," \u0438\u0437 ",e.items.length),c.a.createElement("button",{className:u.a.close,onClick:e.onBackClick},"\u041d\u0430\u0437\u0430\u0434"),c.a.createElement("div",{className:u.a.carousel,ref:n},e.items.map((e,t)=>c.a.createElement("div",{className:u.a.image,key:e.large2x.url},c.a.createElement(o.a,{src:e.large,src2x:e.large2x,bgColor:e.bgColor,alt:"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f ".concat(t+1)}))))),document.body)},_=a(312),b=a.n(_),v=e=>{var[t,a]=Object(l.useState)(-1),n=Object(l.useMemo)(()=>e.items.filter(Boolean),[e.items]),s=Object(l.useCallback)(e=>{var t=e.currentTarget,l=Array.prototype.indexOf.call(t.parentElement.children,t);a(l)},[]),r=Object(l.useCallback)(()=>{a(-1)},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:b.a.container},n.map((e,t)=>c.a.createElement("div",{className:b.a.thumbnail,key:e.thumbnail2x.url,onClick:s},c.a.createElement(o.a,{className:b.a.image,src:e.thumbnail,src2x:e.thumbnail2x,bgColor:e.bgColor,alt:"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f ".concat(t+1)})))),-1!==t&&c.a.createElement(d,{items:n,onBackClick:r,startIndex:t}))},E=a(58),p=a(313),f=a.n(p),y=e=>{var t=Object(l.useRef)(null),a=Object(l.useRef)(null),[n,s]=Object(l.useState)(!1);Object(l.useEffect)(()=>{if(t.current&&a.current){var e=t.current.getBoundingClientRect(),l=a.current.getBoundingClientRect();e.height===l.height&&s(!0)}},[t,a,e.lines]);var r=Object(l.useCallback)(()=>s(!0),[s]);return c.a.createElement(c.a.Fragment,null,!n&&c.a.createElement("div",{ref:t,className:[e.className,f.a.short].filter(Boolean).join(" "),style:{WebkitLineClamp:e.lines}},e.children),c.a.createElement("div",{className:[e.className,!n&&f.a.hidden].filter(Boolean).join(" "),ref:a},e.children),!n&&c.a.createElement(E.a,{className:f.a.button,onClick:r},e.fullTextLabel))},j=a(70),O=a(113),g=a(161),h=(e,t,a)=>{var[c,n]=Object(l.useState)(()=>a(t)),s=Object(l.useCallback)(Object(g.a)(50,()=>{n(a(t))}),[n,e,t,a]);return Object(l.useEffect)(()=>{var{current:t}=e;return null===t||void 0===t||t.addEventListener("scroll",s),()=>{null===t||void 0===t||t.removeEventListener("scroll",s)}},[e,t,s]),Object(l.useEffect)(()=>{s()},[s,e,t]),c},k=a(36),N=a(306),C=a(307),x=a(316),w=a.n(x),R=({event:e,imageRef:t})=>{var{title:a,argument:l,image:n,tags:s,contentRating:r}=e,i=[...(s||[]).map(e=>e.name),r].filter(Boolean).join("  \u2022  ");return c.a.createElement("div",{className:w.a.cover,ref:t},n&&c.a.createElement(o.a,{className:w.a.image,src:n.touchPrimary,bgColor:n.bgColor}),c.a.createElement("div",{className:w.a.fade}),c.a.createElement("div",{className:w.a.overview},c.a.createElement("h1",{className:w.a.title},a),c.a.createElement("div",{className:w.a.argument},l),c.a.createElement("div",{className:w.a.tags},i)))},S=a(24),B=a(120),D=a(116),L=a(295),P=a(12),A=a(317),F=a.n(A),q=({className:e,event:t,ticket:a})=>{var{title:l,image:n}=t;return c.a.createElement("div",{className:[F.a.container,e].join(" ")},n&&n.touchPrimary?c.a.createElement(o.a,{className:F.a.image,alt:l,src:n.touchPrimary,bgColor:n.bgColor}):c.a.createElement("div",{className:F.a.preview}),c.a.createElement("div",{className:F.a.title},l),c.a.createElement("div",{className:F.a.price},c.a.createElement(D.a,{ticket:a,exact:!0})))},I=a(77),U=a(318),Z=a.n(U),T=({className:e,label:t,type:a,value:n,onChange:s,onFocus:r,required:i})=>{var o=Object(l.useCallback)(e=>{s(e.target.value)},[s]);return c.a.createElement("label",{className:[Z.a.container,e].join(" ")},c.a.createElement("div",{className:Z.a.label},t),c.a.createElement(I.a,{className:Z.a.input,type:a,value:n,onChange:o,onFocus:r,required:i}))},Y=a(319),W=a.n(Y),z={url:"".concat("https://yandex.github.io/miniapp-example","/logo192.png"),width:192,height:192},H=({className:e,ticket:t})=>c.a.createElement("div",{className:[W.a.container,e].join(" ")},c.a.createElement(o.a,{className:W.a.image,src:z,alt:"MiniApp Example"}),c.a.createElement("div",{className:W.a.serviceName},"MiniApp Example"),c.a.createElement("div",{className:W.a.price},c.a.createElement(D.a,{ticket:t,exact:!0}))),J=a(320),M=a.n(J),Q=({event:e,ticket:t,visible:a,onClose:s})=>{var r,i=Object(n.b)(),o=Object(l.useRef)(null),m=Object(l.useRef)(null),[u,d]=Object(l.useState)(""),[_,b]=Object(l.useState)(""),[v,E]=Object(l.useState)(""),[p,f]=Object(l.useState)(!1),y=Object(n.c)(P.e),j=Object(n.c)(P.f),O=Object(n.c)(P.i),g=Object(n.c)(S.j),h=[M.a.modal,a?M.a.visible:M.a.hidden].join(" ");Object(L.a)(o,e=>{a&&(e.preventDefault(),s())},["touchend"]);var k=Object(l.useCallback)(e=>{o.current&&a&&(o.current.contains(e.target)||e.preventDefault())},[a,o]),N=Object(l.useCallback)(t=>{t.preventDefault(),document.activeElement.blur(),i(Object(S.a)(e,{name:u,phone:_,email:v}))},[i,e,u,v,_]),C=Object(l.useCallback)(()=>{!y||j||p||(f(!0),i(Object(P.b)()))},[i,y,j,p]);Object(l.useEffect)(()=>{d(e=>e||O.name||""),E(e=>e||O.email||"")},[O]),Object(l.useEffect)(()=>{a||document.activeElement.blur()},[a]);var x="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043e\u043f\u043b\u0430\u0442\u0435";return u?_?v?g&&(x="\u041e\u043f\u043b\u0430\u0442\u0430\u2026"):x="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 email":x="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d":x="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0438\u043c\u044f",c.a.createElement("div",{className:h,onTouchStart:k},c.a.createElement("div",{ref:o,className:M.a.content},c.a.createElement(q,{className:M.a.event,event:e,ticket:t}),c.a.createElement("form",{ref:m,action:"",onSubmit:N},c.a.createElement(T,{className:M.a.input,label:"\u0418\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044f",value:u,onChange:d,onFocus:C,required:!0}),c.a.createElement(T,{className:M.a.input,label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel",value:_,onChange:b,required:!0}),c.a.createElement(T,{className:M.a.input,label:"Email \u0430\u0434\u0440\u0435\u0441",type:"email",value:v,onChange:E,onFocus:C,required:!0}),c.a.createElement(H,{className:M.a.total,ticket:t}),c.a.createElement(B.a,{type:"submit",className:M.a.button,formInvalid:!(null===(r=m.current)||void 0===r?void 0:r.checkValidity()),disabled:g},x))))},G=a(321),K=a.n(G),V={Yes:K.a["sticky-visible_yes"],No:K.a["sticky-visible_no"]},X=({ticket:e,disabled:t,onClick:a})=>c.a.createElement(B.a,{className:K.a.button,disabled:t,onClick:a},"\u0411\u0438\u043b\u0435\u0442\u044b ",c.a.createElement(D.a,{ticket:e})),$=e=>{var t,a;return Number(null===(t=e.current)||void 0===t||null===(a=t.getBoundingClientRect())||void 0===a?void 0:a.top)<0},ee=({event:e})=>{var t=Object(n.b)(),a=Object(l.useRef)(null),s=Object(j.b)(),r=Object(l.useRef)(document),o=Object(k.a)()?r:s,[m,u]=Object(l.useState)(""),[d,_]=Object(l.useState)(s.current),b=Object(n.c)(S.c),v=Object(l.useCallback)(()=>{t(Object(S.d)())},[t]),E=Object(l.useCallback)(()=>{t(Object(S.b)())},[t]),p=h(o,a,$),f=e.tickets&&e.tickets[0];return Object(l.useEffect)(()=>{a.current&&f&&((p||m===V.Yes)&&u(p?V.Yes:V.No))},[a,p,f,m]),Object(l.useEffect)(()=>{_(s.current)},[s]),Object(l.useEffect)(()=>()=>{E()},[E]),f?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:K.a.static,ref:a},c.a.createElement(X,{ticket:f,onClick:v})),c.a.createElement("div",{className:[K.a.sticky,m].join(" ")},c.a.createElement(X,{ticket:f,onClick:v})),d&&Object(i.createPortal)(c.a.createElement(Q,{event:e,ticket:f,visible:b,onClose:E}),d)):null};function te(e){var t=new URLSearchParams({l:"map"});for(var[a,l]of Object.entries(e))t.set(a,String(l));return"//static-maps.yandex.ru/1.x/?".concat(t)}var ae=a(322),le=a.n(ae),ce=Object(l.lazy)(()=>Promise.all([a.e(11),a.e(8)]).then(a.bind(null,336))),ne=e=>c.a.createElement("div",{className:le.a.station},e.colors.map(e=>c.a.createElement("div",{style:{backgroundColor:e},key:e,className:le.a["metro-point"]})),e.name),se=e=>{var{coordinates:t,metro:a,address:n}=e,s=Object(l.useMemo)(()=>[t.longitude,t.latitude],[t]);return Object(i.createPortal)(c.a.createElement("div",{className:le.a.modal},c.a.createElement("div",{className:le.a.close},c.a.createElement("button",{className:le.a["close-button"],onClick:e.onBackClick},"\u041d\u0430\u0437\u0430\u0434")),c.a.createElement(l.Suspense,{fallback:null},c.a.createElement(ce,{point:s})),(a||n)&&c.a.createElement("div",{className:le.a["metro-containter"]},a&&a.map(e=>c.a.createElement(ne,Object.assign({key:e.name},e))),n)),document.body)},re=a(323),ie=a.n(re),oe=e=>{var t={url:te({size:[650,176],z:16,pt:[e.coordinates.longitude,e.coordinates.latitude,"pm2rdl"]}),width:650,height:176},[a,n]=Object(l.useState)(!1),s=Object(l.useCallback)(()=>{n(!0),document.body.style.overflow="hidden"},[]),r=Object(l.useCallback)(()=>{n(!1),document.body.style.overflow="auto"},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:s},c.a.createElement(o.a,{className:ie.a.map,src:t})),a&&c.a.createElement(se,Object.assign({},e,{onBackClick:r})))},me=a(324),ue=a.n(me),de=({schedule:e})=>{var{oneOfPlaces:t,placePreview:a}=e;return t&&t.coordinates?c.a.createElement(c.a.Fragment,null,c.a.createElement(oe,{coordinates:t.coordinates,metro:t.metro,address:t.address}),c.a.createElement("div",{className:ue.a.title},t.title),c.a.createElement("div",{className:ue.a.address},t.address)):c.a.createElement("div",{className:ue.a.title},a)},_e=a(25),be=a(305),ve=({children:e,skeleton:t,fetchData:a})=>(Object(l.useEffect)(()=>{a&&a()},[a]),c.a.createElement(l.Suspense,{fallback:t||null},e)),Ee=({children:e,skeleton:t,fetchData:a})=>c.a.createElement(be.a,{skeleton:t},c.a.createElement(ve,{children:e,skeleton:t,fetchData:a})),pe=a(162),fe=Object(_e.a)(()=>a.e(4).then(a.bind(null,339))),ye=Object(l.memo)(()=>c.a.createElement(Ee,{skeleton:c.a.createElement(pe.a,null)},c.a.createElement(fe,{skeleton:c.a.createElement(pe.a,null)}))),je=a(325),Oe=a.n(je),ge=e=>{var t;return Object(k.a)()?window.scrollY<=0:!e.current||(null===(t=e.current)||void 0===t?void 0:t.scrollTop)<=0};t.default=({id:e,skeleton:t})=>{var a=Object(l.useRef)(null),i=Object(j.b)(),o=Object(l.useRef)(document),m=Object(k.a)()?o:i,u=Object(j.c)(),d=Object(n.c)(t=>t.event.data[e])||{},_=d.event||{},b=d.schedule||{},E=!_.id,{images:p,description:f,type:g,tickets:x}=_,{preview:w}=b,S=x&&x[0],B=h(m,i,ge);return Object(O.a)(),Object(l.useEffect)(()=>{u&&Object(s.c)(_)},[u,_]),E?t:c.a.createElement(c.a.Fragment,null,c.a.createElement(r.a,{mods:B?"clear":"",backward:B?"white":"black",hasLogo:!1,hasMenu:!1}),c.a.createElement(R,{event:_,imageRef:a}),c.a.createElement("div",{className:Oe.a.wrapper},c.a.createElement(ee,{event:_}),g&&c.a.createElement("div",{className:Oe.a.city},g.name," \u0432 \u041c\u043e\u0441\u043a\u0432\u0435"),w&&c.a.createElement("div",{className:Oe.a.schedule},w.text),c.a.createElement(C.a,null,c.a.createElement(de,{schedule:b})),p&&p.length>0&&c.a.createElement(C.a,null,c.a.createElement(N.a,null,"\u0424\u043e\u0442\u043e\u0433\u0430\u043b\u0435\u0440\u0435\u044f"),c.a.createElement(v,{items:p})),f&&c.a.createElement(C.a,null,c.a.createElement(N.a,null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),c.a.createElement(y,{lines:5,className:Oe.a.description,fullTextLabel:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"},f)),c.a.createElement(ye,null),S&&c.a.createElement("div",{className:Oe.a.placeholder})))}}}]);
//# sourceMappingURL=event-screen.25eb3c91.chunk.js.map